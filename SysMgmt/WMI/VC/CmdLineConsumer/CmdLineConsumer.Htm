<!- Copyright (c)  Microsoft Corporation, All Rights Reserved ->
<!doctype html public "-//W3C//DTD HTML 4.0 Draft//EN">
<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:p="urn:schemas-microsoft-com:office:powerpoint"
xmlns:oa="urn:schemas-microsoft-com:office:activation"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1251">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 10">
<meta name=Originator content="Microsoft Word 10">
<link rel=File-List href="CmdLineConsumer_files/filelist.xml">
<title>WMI SDK Sample - CmdLineConsumer</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Michael Maston</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>Zina Pozen</o:LastAuthor>
  <o:Revision>24</o:Revision>
  <o:TotalTime>193</o:TotalTime>
  <o:Created>1999-01-25T03:17:00Z</o:Created>
  <o:LastSaved>2002-05-03T21:12:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>657</o:Words>
  <o:Characters>3750</o:Characters>
  <o:Company>Microsoft</o:Company>
  <o:Lines>31</o:Lines>
  <o:Paragraphs>8</o:Paragraphs>
  <o:CharactersWithSpaces>4399</o:CharactersWithSpaces>
  <o:Version>10.3501</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-alt:"MS Mincho";
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-alt:"?? ??";
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:1627421319 -2147483648 8 0 66047 0;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536871559 0 0 0 415 0;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:994183607;
	mso-list-type:hybrid;
	mso-list-template-ids:-208100182 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l0:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Times New Roman";}
@list l0:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1
	{mso-list-id:1154177603;
	mso-list-type:hybrid;
	mso-list-template-ids:-154137990 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l1:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";}
</style>
<![endif]-->
<meta name=MS-HAID content=VJsamples>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="4098"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor=white lang=EN-US link=blue vlink=blue style='tab-interval:.5in'>

<div class=Section1>

<table class=MsoNormalTable border=0 cellpadding=0 width="100%"
 style='width:100.0%;mso-cellspacing:1.5pt;mso-padding-alt:0in 0in 0in 0in'>
 <tr style='mso-yfti-irow:0;mso-yfti-lastrow:yes'>
  <td width=160 style='width:120.0pt;background:#330099;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span style='font-size:10.0pt;font-family:Verdana;
  color:white'>&nbsp;<nobr><b>Windows Management Instrumentation SDK Sample</b></span>
  <o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=MsoPlainText><br>
<span class=SpellE><strong><span style='font-size:13.5pt;font-family:Verdana;
mso-bidi-font-family:"Courier New"'>CmdLineConsumer</span></strong></span><br>
<br>
<span style='font-family:Verdana;mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Times New Roman"'>The <span class=SpellE>CmdLineConsumer</span>
sample demonstrates a generic event consumer.<span style='mso-spacerun:yes'> 
</span>Based upon the event received, this sample will spawn a user-defined
application.<span style='mso-spacerun:yes'>  </span>Specifically, if an
instance creation event is detected, the <span class=SpellE>CmdLineConsumer</span>
sample will invoke the Windows Notepad application.<span
style='mso-spacerun:yes'>  </span>This behavior is defined in the sample MOF
file, <span class=SpellE>cmdline.mof</span>.<span style='mso-spacerun:yes'> 
</span>Naturally, different event criteria can be defined and other
applications can be invoked by modifying the MOF file.<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:Verdana'>Building the <span class=SpellE>CmdLineConsumer</span>
Sample<o:p></o:p></span></p>

<p class=MsoPlainText>&nbsp;</p>

<p class=MsoPlainText><span style='font-family:Verdana'>The application can be
built from the command line using NMAKE, or it can be built using Microsoft
Visual C++.<span yes>&nbsp; </span><o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana'>&nbsp;<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana'>From the command line
in the sample installation directory: <o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana'>&nbsp;<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:.25in'><b><span style='font-family:
Verdana'>NMAKE /f &quot;<span class=SpellE>Makefile</span>&quot;<o:p></o:p></span></b></p>

<p class=MsoPlainText><span style='font-family:Verdana'>&nbsp;<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana'>From Microsoft Visual
C++: <o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana'>&nbsp;<o:p></o:p></span></p>

<p class=MsoPlainText l0 level1 lfo2 list .5in><span style='font-family:Verdana'>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Select File + Open Workspace<o:p></o:p></span></p>

<p class=MsoPlainText l0 level1 lfo2 list .5in><span style='font-family:Verdana'>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Select the <span class=SpellE>CmdLineConsumer.dsp</span> file<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:Verdana'>Registering the Consumer to Receive Events<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'>In order to register the
event consumer, the MOF must be compiled using the MOFCOMP program </span><span
style='font-family:Verdana'>at the command line in the sample installation
directory</span><span style='font-family:Verdana;mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:"Times New Roman"'>:<o:p></o:p></span></p>

<p class=MsoPlainText><i><span style='font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho"'><o:p>&nbsp;</o:p></span></i></p>

<p class=MsoPlainText style='margin-left:.5in'><span class=SpellE><b><span
style='font-family:Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Times New Roman"'>mofcomp</span></b></span><b><span style='font-family:Verdana;
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'> <span
class=SpellE>cmdline.mof</span><o:p></o:p></span></b></p>

<p class=MsoPlainText style='margin-left:.5in'><b><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></b></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'>In order to <i>explicitly</i>
register the consumer with COM, you may specify the /<span class=SpellE>RegServer</span>
command line switch when running the executable</span><span style='font-family:
Verdana'> at the command line in the sample installation directory</span><span
style='font-family:Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Times New Roman"'>:<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span style='mso-tab-count:
1'>          </span><o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span style='mso-tab-count:
1'>          </span><b>Cmdlineconsumer.exe /<span class=SpellE>RegServer</span><o:p></o:p></b></span></p>

<p class=MsoPlainText><b><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></b></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'>It should be noted,
however, that the executable would register itself automatically without
specifying this switch.<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;
font-family:Verdana'>Notes About <span class=SpellE>CmdLine.MOF</span><o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'>Within the MOF file, the
logical consumer is defined as:<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'>class <span class=SpellE>CmdLineEventConsumer</span>
: __<span class=SpellE>EventConsumer</span><o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'>{<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style='mso-spacerun:yes'>    </span>[key] string Name;<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span style='mso-tab-count:
1'>          </span>[read, write]<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style='mso-spacerun:yes'>    </span>string <span class=SpellE>cmdLine</span>;<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span style='mso-tab-count:
1'>          </span>[read, write]<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style='mso-spacerun:yes'>    </span>uint8 <span class=SpellE>showWindow</span>;<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'>};<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'>Where:<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:.5in;text-indent:-.25in;mso-list:l1 level1 lfo2;
tab-stops:list .5in'><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><i><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'>Name</span></i><span
style='font-family:Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Times New Roman"'> is any convenient string.<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:.5in;text-indent:-.25in;mso-list:l1 level1 lfo2;
tab-stops:list .5in'><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span class=SpellE><i><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'>cmdLine</span></i></span><span
style='font-family:Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Times New Roman"'> is the shell command line to be executed when this consumer
instance is called.<o:p></o:p></span></p>

<p class=MsoPlainText style='margin-left:.5in;text-indent:-.25in;mso-list:l1 level1 lfo2;
tab-stops:list .5in'><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span class=SpellE><i><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'>showWindow</span></i></span><span
style='font-family:Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Times New Roman"'> is a value used to control the command prompt window in
which the <span class=SpellE><i>cmdLine</i></span> will be run. These values
are defined by the <span class=SpellE>ShowWindow</span>() function in the Win32
API. For reference, they are:<o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style='mso-tab-count:1'>          </span>#define SW_HIDE<span style='mso-tab-count:
4'>                                  </span>0<o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style='mso-tab-count:1'>          </span>#define SW_SHOWNORMAL<span
style='mso-tab-count:3'>                      </span>1<o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style='mso-tab-count:1'>          </span>#define SW_NORMAL<span
style='mso-tab-count:4'>                              </span>1<o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style='mso-tab-count:1'>          </span>#define SW_SHOWMINIMIZED<span
style='mso-tab-count:2'>                  </span>2<o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style='mso-tab-count:1'>          </span>#define SW_SHOWMAXIMIZED<span
style='mso-tab-count:2'>                 </span>3<o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style='mso-tab-count:1'>          </span>#define SW_MAXIMIZE<span
style='mso-tab-count:3'>                           </span>3<o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style='mso-tab-count:1'>          </span>#define SW_SHOWNOACTIVATE<span
style='mso-tab-count:2'>               </span>4<o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style='mso-tab-count:1'>          </span>#define SW_SHOW<span style='mso-tab-count:
4'>                                </span>5<o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style='mso-tab-count:1'>          </span>#define SW_MINIMIZE<span
style='mso-tab-count:3'>                            </span>6<o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style='mso-tab-count:1'>          </span>#define SW_SHOWMINNOACTIVE<span
style='mso-tab-count:2'>              </span>7<o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style='mso-tab-count:1'>          </span>#define SW_SHOWNA<span
style='mso-tab-count:3'>                             </span>8<o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style='mso-tab-count:1'>          </span>#define SW_RESTORE<span
style='mso-tab-count:3'>                             </span>9<o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><span
style='mso-tab-count:1'>          </span>#define SW_SHOWDEFAULT<span
style='mso-tab-count:3'>                     </span>10<o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><b><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'>NOTE:</span></b><span
style='font-family:Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Times New Roman"'><span style='mso-spacerun:yes'>  </span>The <span
class=SpellE><i>showWindow</i></span> property of the <span class=SpellE>CmdLineEventConsumer</span>
class only accepts numerical values and will not be able to resolve the Win32
symbolic names (e.g., SW_MINIMIZE).<o:p></o:p></span></p>

<p class=MsoNormal style='tab-stops:list .5in'><br>
<strong><span style='font-family:Verdana;font-weight:normal'>General Notes</span></strong><strong><span
style='mso-fareast-font-family:"MS Mincho";font-weight:normal'><o:p></o:p></span></strong></p>

<p class=MsoNormal style='tab-stops:list .5in'><strong><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";font-weight:normal'><o:p>&nbsp;</o:p></span></strong></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'>Things
to remember when you're building your own WMI client application:</span><span
style='mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='margin-left:.25in;text-indent:-.25in;mso-list:
l0 level1 lfo4;tab-stops:list .25in .5in'><![if !supportLists]><span
style='font-family:"Times New Roman"'><span style='mso-list:Ignore'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'>If you want your client to
run on NT and non-DCOM versions of Windows 95, manually load the ole32.dll and
see if <span class=SpellE>CoInitializeSecurity</span>() exists. This routine
won’t exist on Windows 95 installations that don’t have DCOM installed
separately. If this routine doesn't exist, the asynchronous routines in this
sample won’t work because of mismatched security level problems. The
synchronous techniques will still work.<o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='margin-left:.25in;text-indent:-.25in;mso-list:
l0 level1 lfo4;tab-stops:list .25in .5in'><![if !supportLists]><span
style='font-family:"Times New Roman"'><span style='mso-list:Ignore'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'>If you don’t care about
non-DCOM versions of Windows 95, you can define<span style='mso-spacerun:yes'> 
</span>_WIN32_DCOM so that <span class=SpellE>CoInitializeSecurity</span>() is
available for implicit linking. Don't use _WIN32_WINNT to get this prototype
since it won't compile under the Windows 95/98 operating systems.<o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='margin-left:.25in;text-indent:-.25in;mso-list:
l0 level1 lfo4;tab-stops:list .25in .5in'><![if !supportLists]><span
style='font-family:"Times New Roman"'><span style='mso-list:Ignore'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'>In any case, the <span
class=SpellE>CoInitializeSecurity</span>() call (in <span class=SpellE>InitInstance</span>())
is required to work around a security problem when WMI trying to call a Sink
object but won't identify itself. The <span class=SpellE>CoInitializeSecurity</span>()
call turns off the authentication requirement. <o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='margin-left:.25in;text-indent:-.25in;mso-list:
l0 level1 lfo4;tab-stops:list .25in .5in'><![if !supportLists]><span
style='font-family:"Times New Roman"'><span style='mso-list:Ignore'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'>WMI interfaces are defined in
<span class=SpellE>wbemcli.h</span> and <span class=SpellE>wbemprov.h</span>
found in the <span class=SpellE>wbem</span>\include directory.<span
style='mso-spacerun:yes'>  </span>You may #include both these files by
including just <span class=SpellE>wbemidl.h</span> located in the same
directory.<o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='margin-left:.25in;text-indent:-.25in;mso-list:
l0 level1 lfo4;tab-stops:list .25in .5in'><![if !supportLists]><span
style='font-family:"Times New Roman"'><span style='mso-list:Ignore'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'>WMI interface <span
class=SpellE>CLSIDs</span> are defined in <span class=SpellE>wbemuuid.lib</span>.
If you get unresolved externals in interfaces and <span class=SpellE>CLSIDs</span>,
this is what is missing. <o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='margin-left:.25in;text-indent:-.25in;mso-list:
l0 level1 lfo4;tab-stops:list .25in .5in'><![if !supportLists]><span
style='font-family:"Times New Roman"'><span style='mso-list:Ignore'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'>You'll need to link with
oleaut32.lib and ole32.lib to get the needed COM support.<o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='margin-left:.25in;text-indent:-.25in;mso-list:
l0 level1 lfo4;tab-stops:list .25in .5in'><![if !supportLists]><span
style='font-family:"Times New Roman"'><span style='mso-list:Ignore'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Times New Roman"'>In the <span class=SpellE>Link|Output</span>
settings, specify '<span class=SpellE>wWinMainCRTStartup</span>' as the entry
point. This is per the Unicode programming instructions.<o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:list .5in'><span style='font-family:
Verdana;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='margin-left:.25in;text-indent:-.25in;mso-list:
l0 level1 lfo4;tab-stops:list .25in .5in'><![if !supportLists]><span
style='font-family:"Times New Roman"'><span style='mso-list:Ignore'>8.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho"'>If you're using the <span class=SpellE>makefiles</span>, don't
forget to set the Visual C++ environment variables. This is done by running
VCVARS32.BAT.<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText style='margin-left:.25in;text-indent:-.25in;mso-list:
l0 level1 lfo4;tab-stops:list .25in .5in'><![if !supportLists]><span
style='font-family:"Times New Roman"'><span style='mso-list:Ignore'>9.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:Verdana;mso-fareast-font-family:
"MS Mincho"'>If you are running Microsoft Visual Studio .NET, you should modify
the sample’s MAKEFILE (and/or project file) to reference MFC70 libraries
instead of MFC42 libraries which shipped with earlier versions of Visual C++.<o:p></o:p></span></p>

<p class=MsoNormal style='tab-stops:list .5in'><br style='mso-special-character:
line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]></p>

</div>

</body>

</html>
