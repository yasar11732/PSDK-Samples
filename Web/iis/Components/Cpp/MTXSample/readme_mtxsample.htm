<head><title>MTXSample</title></head>
<body>
 <a name="top"></a>
 <p>
 <h2>MTXSample</h2>
 <a name="IIS_MTXSample"></a>

 <p>
  The mtxsample sample shows how to perform a transaction.  
  It involves multiple database updates using MTS/COM. 
 </p>

 <p>
  <font color="blue">
   <b>Important</b></font> &nbsp; These samples are provided for educational     purposes only. They are not intended to be used in a production environment, 
    have not been tested in a production environment, and Microsoft does not 
    provide technical support for them.
 </p>
 <p>
  <a href="#ovr">Sample Overview</a><br>
  <a href="#req">Requirements</a><br>
  <a href="#loc">Location of the Source Code</a><br>
  <a href="#bld">Build and Install the Sample</a><br>
  <a href="#run">Run the Sample</a><br>
  <a href="#hlp">Helpdesk</a>
 </p>

 <p>&nbsp;</p>

 <h4><a name="ovr"></a>Sample Overview</h4>

 <p>
  The mtxsample sample is very similar to the old MTS SDK VC sample, but instead 
  of using a VB application as the client, we use ASP as the client.
 </p>
 <p>
  The component has three objects:

  <ul>
   <li>BankVC.Account</li>
   <li>BankVC.CreateTable</li>
   <li>BankVC.MoveMoney</li>
  </ul>
 </p>

 <font size="2"><a href="#top">to top</a></font>

 <p>&nbsp;</p>

 <h4><a name="req"></a>Requirements</h4>

 <p>
  This sample requires the installation of the following software to function properly:
 </p>
 <ul>
  <li>Windows XP Professional with IIS 5.1 installed or Windows XP Server with 
      IIS 6.0 installed.</li>
 </ul>

 <font size="2"><a href="#top">to top</a></font>

 <p>&nbsp;</p>

 <h4><a name="loc"></a>Location of the Source Code</h4>

 <p>
  IIS samples are included in the IIS Software Developer Kit (SDK). You can download the IIS 
  SDK from <a href="http://go.microsoft.com/fwlink/?LinkId=7298">Platform SDK Update</a>. 
  You can view the SDK at <a href="msdn_home" class="weblink">MSDN Online</a>. In the 
  table of contents at MSDN Online, click <b>Web Development</b>, <b>Server Technologies</b>,
  <b>Internet Information Services (IIS)</b>, <b>SDK Documentation</b>, 
  <b>Internet Information Services</b>, <b>Samples</b>.
 </p>
 <p>
  The following source code files are required for this sample:
 </p>

 <table border="1">
  <tr>
   <th>File</th>
   <th>Description</th>
  </tr>
  <tr>
   <td>MTXSample.sln</td>
   <td>
    MTXSample Visual Studio .NET solution file, required to build this sample in 
    Visual Studio .NET.
   </td>
  </tr>
  <tr>
   <td>MTXSample.vcproj</td>
   <td>
    MTXSample Visual Studio .NET C Project file, required to build this sample in Visual     Studio .NET.
   </td>
  </tr>
  <tr>
   <td>MTXSample.dsp, MTXSample.dsw</td>
   <td>
    MTXSample Visual Studio 6.0 project files, required to build this sample in Visual     Studio Version 6.
   </td>
  </tr>
  <tr>
   <td>
    Account.cpp, BankVC.cpp, CreateTable.cpp, MoveMoney.cpp, StdAfx.cpp
   </td>
   <td>Source modules containing the code that implements the sample.</td>
  </tr>
  <tr>
   <td>BankVC.def, BankVCps.def</td>
   <td>DLL definitions containing code for creating the sample.</td>
  </tr>
  <tr>
   <td>Account.h, CreateTable.h, MoveMoney.h, resource.h, StdAfx,h</td>
   <td>MTXSample header file containing commonly called routines.</td>
  </tr>
  <tr>
   <td>BankVC.mak</td>
   <td>Sample makefile for command line compilation</td>
  </tr>
  <tr>
   <td>MTXSample.asp</td>
   <td>Sample web files, required to illustrate how the sample file is used.</td>
  </tr>
 </table>

 <br>

 <font size="2"><a href="#top">to top</a></font>

 <p>&nbsp;</p>

 <h4><a name="bld"></a>Build and Install the Sample</h4>

 <p>
  To build  this sample using the Visual C++ IDE, the following steps must be performed:
 </p>
 
 <ol>
  <li>Open the solution (VS.NET) or desktop (VS6) file to open the project.</li>
  <li>Click <b>Build</b> to create the DLL.</li>
 </ol>

 <p>
  To build and run this sample without using the Visual C++ IDE, the following steps 
  must be performed:
 </p>
 
 <ol>
  <li>
   Type <b>NMAKE All</b> from the command line. For example, if your sample files are 
   located in a folder called <code>C:\MySamples</code>, type the following at the 
   command line: <pre>cd /d c:\MySamples NMAKE BankVC.mak All</pre>
  </li>
 </ol>

 <p>&nbsp;</p>

 <p>To install this sample, the following steps must be performed:</p>

 <ol>
  <li>
   Copy the DLL and ASP files to a physical folder on your computer. For example, 
   create a folder called <code>C:\Samples</code> and copy the <i>whatever_files</i> to that 
   folder.
  </li>
  <li>
   In Component Services Manager, under COM+ Applications, create a New Application.  
   Select "Create an empty application" called IIS Sample, and select the 
   "Library application" radio button.
  </li>
  <li>
   Under IIS Sample, right-click on Components, New Component, "Install new component(s)".
   Enter the path to your BankVC.dll.
  </li>
  <li>
   Under IIS Sample, Components, right-click on each object listed, select Properties, 
   Transactions, and set the "Transaction support" as follows:
   <p>
    BankVC.Account     -> Required<br>
    BankVC.CreateTable -> Requires New<br>
    BankVC.MoveMoney   -> Required<br>
   </p>
   <p>  
    Note: Asp provides a transaction by default. If you do not want this sample to use the     transaction control provided by ASP, set the "Transaction support" for BankVC.MoveMoney to     Requires New.
   </p>
  </li>
 </ol>

 <font size="2"><a href="#top">to top</a></font>

 <p>&nbsp;</p>

 <h4><a name="run"></a>Run the Sample</h4>

 <p>
  In order to run this sample, follow the instructions listed below:
 </p>

 <ol>
  <li>
   Browse to your sample Web files in Internet Explorer (IE). For example, 
   if your files are in a virtual directory called <code>MTXSample</code>, type 
   <code>http://localhost/MTXSample/BankVC.asp</code> in the <b>Address</b> bar
   of IE.
  </li>
 </ol>

 <font size="2"><a href="#top">to top</a></font>

 <p>&nbsp;</p>

 <h4><a name="hlp"></a>Help Desk</h4>

 <p>
  If here you do not find answers to your questions, visit the 
  <a href="http://go.microsoft.com/fwlink/?linkid=1782">Microsoft Help and Support</a> 
  Web site.
 </p>

 <table border="1">
  <tr>
   <th>Problem</th>
   <th>Possible Solution</th>
  </tr>
  <tr>
   <td>When browsing to the ASP page, IE returns <b>HTTP 404 - File not found</b></td>
   <td>
    Verify that you have created a virtual directory of the same name you
    are typing in the Address box of IE....
   </td>
  </tr>
  <tr>
   <td>When building the dll, C++ or VB returns the a permissions error.</td>
   <td>
    Once you have called the dll from your web page, your system considers
    it a loaded dll. You must unload it to build it again, either by
    unloading the ASP application or deleting the dll from system32\dllcache.
   </td>
  </tr>
  <tr>
   <td>When building the dll, C++ returns a permissions error.</td>
   <td>
    Once you have called the dll from your web page, your system considers
    it a loaded dll. You must unload it to build it again, either by
    unloading the ASP application or deleting the dll from system32\dllcache.
   </td>
  </tr>
  <tr>
   <td>When browsing to the dll, IE gives you a permissions error.</td>
   <td>The folder and virtual directory must have Execute permissions set on them.</td>
  </tr>
 </table>

 <br>
 
 <font size="2"><a href="#top">to top</a></font>

 <hr class="iis" size="1">

 <p align="center">
  <i><a href="colegal.htm">© 1997-2002 Microsoft Corporation. All rights reserved</a>.</i>
 </p>

</body></html>

