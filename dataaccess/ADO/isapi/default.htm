<!-- 
 File:			default.htm
 Description:	ADO 2.7 Sample Application
				ISAPI DLL Using ADO
 Copyright:		Copyright (c) 1991-2001 Microsoft Corporation
-->

<HTML>
<HEAD><TITLE>ADO In An ISAPI Extension</TITLE>
</HEAD>
<BODY>
<LINK REL="STYLESHEET" HREF="..\ADOStyle.css">

<H2>A Sample ISAPI Application using ADO</H2>
<P>

<FORM ACTION="http://localhost/adosamp/isapi/isapi.dll" METHOD=GET>
	SQL Query: 
<INPUT TYPE="text" SIZE="80" VALUE="SELECT firstname, lastname FROM Employees" NAME="Query">
<INPUT TYPE="submit" VALUE="Execute">
</FORM>
<P>

<H3>Sample Overview</H3>
<UL>
<LI>ISAPI is a sample ISAPI application that runs on Microsoft Internet 
Information Server. The application is written using ActiveX Data Objects 
to fetch data from the database and return the the data back to the 
client in HTML format.</LI>
</UL>

<H3>Setup</H3>
Follow the instructions below to setup this sample.
<UL>
<LI>This sample application assumes you have already created the ADOSamp 
VRoot as specified on the ADOSamp home page.</LI>
<LI>You will need to compile the sample to generate the ISAPI.DLL. 
Before compiling locate the #import statement for MSADO15.DLL 
in ADOISAPI.CPP to ensure it matches the files location on your 
system. Additionally you need to update the connection string 
within the ADOISAPI.CPP source file to match your environment.  
Once the DLL has been compiled, copy it to the following location:
<strong>c:\inetpub\wwwroot\adosamp\isapi\.</strong></LI>
<LI>Using the IIS management console, right-click on the 'Default Web Site' 
and set the following properties: On the 'Home Directory' property page set 
'Execute Permissions' to 'Scripts and Executables'. 'Application Protection' 
should be set to 'Low (IIS Process)'. On the 'ISAPI Filters' property page, 
add a new filter named ADOISAPI, and enter the following path:<strong> 
c:\inetpub\wwwroot\adosamp\isapi\isapi.dll.</strong></LI>
</UL>

<H3>Running the Sample:</H3>
Follow the instructions below to run this sample.
<UL>
<LI>Enter the following URL: http://localhost/adosamp/isapi/default.htm (this page).</LI>
<LI>Click Execute. The results of the default SQL query should appear in a table.</LI>
<LI>This sample was written to the Northwind database, feel free to modify the query to 
access any table or column in this database or modify the ISAPI DLL to access another 
database.</LI>
</UL>

<H3>System Requirements</H3>
This application requires the following system components to run.
<UL>
<LI>Microsoft Windows NT 4.0 or Windows 2000</LI>
<LI>Microsoft Internet Information Services version 4.0 or 5.0</LI>
<LI>Microsoft Visual C++ version 6.0 or newer</LI>
<LI>SQL Server 7.0 or newer</LI>
</UL>

</body>
</html>
